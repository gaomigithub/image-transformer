# 图片格式转换工具

一个功能强大的Python图片格式转换工具，支持将TIF/PNG格式的图片批量转换为常用的JPG和PNG格式，并提供多种批量调整选项。

## 功能特性

- 🖼️ 支持批量转换TIF/TIFF/PNG格式图片
- 📁 可选择输入文件夹进行批量处理
- 🎯 支持选择自定义输出位置
- 🔄 智能输出路径：选择输入位置时自动生成带日期的输出文件夹
- 📏 **批量调整功能**：
  - 📐 缩放比例调整：支持按百分比缩放图片尺寸
  - 💾 文件大小控制：精确控制输出文件大小（KB）
  - 🎨 图片质量等级：1-10级质量控制
- 📊 实时进度条显示转换进度
- 📝 详细的转换日志
- 🛡️ 转换过程中禁用操作按钮，防止重复操作
- 💻 现代化的GUI界面

## 系统要求

- Python 3.6 或更高版本
- Windows/macOS/Linux 操作系统

## 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install Pillow
```

## 使用方法

1. 运行程序：
   ```bash
   python image_converter.py
   ```

2. 在GUI界面中：
   - 点击第一行的"浏览"按钮选择包含图片的输入文件夹
   - 输出文件夹会自动设置为输入文件夹下的 `imgTrans-YYYYMMDD` 格式（如：`imgTrans-20231201`）
   - 如需自定义输出位置，可点击第二行的"浏览"按钮手动选择
   - 在输出格式下拉框中选择目标格式（jpg或png）
   - **选择批量调整选项**（可选）：
     - **不调整**：保持原始图片属性
     - **缩放比例**：输入百分比（如90表示缩小到原图的90%）
     - **文件大小**：输入目标文件大小（如1024表示约1MB）
     - **图片质量**：使用滑块选择1-10的质量等级
   - 点击"开始转换"按钮开始批量转换

3. 转换过程中：
   - 进度条会显示当前转换进度
   - 上方显示正在处理的文件名
   - 下方日志区域显示详细的转换信息和调整结果
   - 转换按钮会被禁用，防止重复操作

4. 转换完成后：
   - 会弹出完成提示对话框
   - 转换后的文件保存在指定的输出文件夹中

## 批量调整功能详解

### 🔸 缩放比例调整
- **功能**：按百分比调整图片尺寸
- **范围**：0-200%
- **示例**：
  - 输入90：图片缩小到原尺寸的90%
  - 输入150：图片放大到原尺寸的150%
- **算法**：使用LANCZOS重采样算法，保证缩放质量

### 🔸 文件大小控制
- **功能**：精确控制输出文件大小
- **单位**：KB（千字节）
- **示例**：
  - 输入1024：输出约1MB大小的图片
  - 输入512：输出约512KB大小的图片
- **算法**：使用二分查找优化JPEG质量参数，在10%误差范围内达到目标大小

### 🔸 图片质量等级
- **功能**：控制图片压缩质量
- **等级**：1-10（10为最佳质量）
- **映射规则**：
  - **JPEG格式**：1级→质量10，10级→质量95
  - **PNG格式**：1级→压缩8，10级→压缩0
- **界面**：滑块控制，实时显示当前等级

## 智能输出路径功能

当您选择输入文件夹时，程序会自动：
- 在输入文件夹下创建以当前日期命名的子文件夹
- 格式：`imgTrans-YYYYMMDD`（如：`imgTrans-20231201`）
- 您也可以手动修改或重新选择输出位置

## 支持的格式

### 输入格式
- TIF/TIFF
- PNG (当转换为其他格式时)

### 输出格式
- JPG (JPEG)
- PNG

## 注意事项

- 程序会自动创建输出文件夹（如果不存在）
- 默认输出文件夹命名格式为 `imgTrans-YYYYMMDD`
- 转换为JPG时，带透明通道的图片会自动添加白色背景
- 不选择调整选项时，JPG格式使用95%的质量设置
- 程序支持大小写混合的文件扩展名
- 输出位置可以是任意有效的文件夹路径
- **批量调整选项互斥**：一次只能选择一种调整方式

## 技术特性

- 使用Tkinter构建GUI界面
- 多线程处理，避免界面卡顿
- PIL/Pillow库进行图片处理
- 支持Windows 10现代化主题样式
- 智能路径变化监听和自动更新
- 高效的图片处理算法：
  - LANCZOS重采样用于缩放
  - 二分查找优化文件大小控制
  - 质量映射算法适配不同格式

## 故障排除

1. **"未找到支持的图片文件"错误**
   - 确保输入文件夹中包含.tif、.tiff或.png格式的文件
   - 检查文件扩展名是否正确

2. **转换失败**
   - 检查图片文件是否损坏
   - 确保输出文件夹路径有效且有写入权限
   - 确保有足够的磁盘空间
   - 查看日志区域的详细错误信息

3. **程序无法启动**
   - 确保已安装Pillow库：`pip install Pillow`
   - 检查Python版本是否为3.6+

4. **输出路径问题**
   - 如果自动生成的输出路径不满意，可手动选择
   - 确保选择的输出路径具有写入权限

5. **调整参数无效**
   - 缩放比例必须在0-200%之间
   - 文件大小必须大于0KB
   - 检查输入的数值格式是否正确

6. **文件大小控制不精确**
   - 系统会在10%误差范围内尽量接近目标大小
   - 对于特别小的目标大小，可能无法精确达到
   - PNG格式的文件大小控制相对较粗糙

## 许可证

本项目使用MIT许可证。 